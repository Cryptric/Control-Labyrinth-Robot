import numpy as np

IMG_SIZE_X = 346
IMG_SIZE_Y = 260

PIXEL_SIZE = 18.5 / 1000

PROCESSING_SIZE_WIDTH = 240
PROCESSING_SIZE_HEIGHT = 180

X_EDGE = IMG_SIZE_X - PROCESSING_SIZE_WIDTH
Y_EDGE = IMG_SIZE_Y - PROCESSING_SIZE_HEIGHT

PROCESSING_X = X_EDGE // 2
PROCESSING_Y = Y_EDGE // 2


X_CONTROL_SIGNAL_HORIZONTAL = 80
Y_CONTROL_SIGNAL_HORIZONTAL = 87

BOARD_LENGTH_X = 275
BOARD_LENGTH_Y = 230

CORNER_MASK_MIN_X, CORNER_MASK_MAX_X = 32, 320
CORNER_MASK_MIN_Y, CORNER_MASK_MAX_Y = 5, 250
CORNER_ANGLE_MAX_DEVIATION = 0.1
LENGTH_MAX_DEVIATION = 0.1

CORNER_BL = (42, 238)
CORNER_BR = (306, 236)
CORNER_TR = (305, 18)
CORNER_TL = (41, 17)

# Perspective corners
P_CORNER_BL = (35, 242)
P_CORNER_BR = (312, 243)
P_CORNER_TR = (311, 9)
P_CORNER_TL = (35, 11)

ZERO_POSITION = np.array([41, 237])


X_FOCAL_AREA_X_MIN, X_FOCAL_AREA_X_MAX = 10, 40
X_FOCAL_AREA_Y_MIN, X_FOCAL_AREA_Y_MAX = 120, 135

Y_FOCAL_AREA_X_MIN, Y_FOCAL_AREA_X_MAX = 160, 180
Y_FOCAL_AREA_Y_MIN, Y_FOCAL_AREA_Y_MAX = 246, 260


K_x = -0.47871840354767187
K_y = -0.34808425720620845

SERVO_MIN_PULSE_WIDTH = 544
SERVO_MAX_PULSE_WIDTH = 2400

g = 9.8 * 1000

dt = 1 / 45.6

STEPS_DEAD_TIME = 3

N = 20
Q = 1
R = 5 * 1000


DISTURBANCE_APPROXIMATION_PROPORTIONAL = 0.0
DISTURBANCE_APPROXIMATION_INTEGRAL = 0.25
DISTURBANCE_APPROXIMATION_DIFFERENTIAL = 0.0

DISTURBANCE_INTEGRAL_CLIP = 0.3

MAX_ITER = 5

U_min = -0.08
U_max = 0.08
du_max = 0.01

servo_backlash_x = {15.0: 0.5233333333333331, 14.0: 0.5800000000000001, 13.0: 0.5933333333333334, 12.0: 0.6966666666666667, 11.0: 0.6066666666666666, 10.0: 0.6366666666666666, 9.0: 0.5266666666666668, 8.0: 0.5166666666666666, 7.0: 0.5533333333333333, 6.0: 0.5133333333333333, 5.0: 0.4533333333333333, 4.0: 0.44, 3.0: 0.48333333333333334, 2.0: 0.4733333333333334, 1.0: 0.4333333333333333, 0.0: 0.3733333333333333, -1.0: 0.4033333333333333, -2.0: 0.36000000000000004, -3.0: 0.3366666666666667, -4.0: 0.3600000000000001, -5.0: 0.32, -6.0: 0.42333333333333334, -7.0: 0.5133333333333335, -8.0: 0.38999999999999996, -9.0: 0.4033333333333333, -10.0: 0.34333333333333343, -11.0: 0.2999999999999998, -12.0: 0.3099999999999999, -13.0: 0.40666666666666657, -14.0: 0.2133333333333335, -15.0: 0.0}
servo_backlash_y = {15.0: 0.43666666666666654, 14.0: 0.5766666666666665, 13.0: 0.6433333333333332, 12.0: 0.7699999999999999, 11.0: 0.8833333333333334, 10.0: 1.0133333333333334, 9.0: 1.0866666666666667, 8.0: 0.9366666666666669, 7.0: 0.8933333333333334, 6.0: 0.8466666666666667, 5.0: 0.7966666666666665, 4.0: 0.7466666666666667, 3.0: 1.0, 2.0: 0.8099999999999999, 1.0: 0.5933333333333334, 0.0: 0.6833333333333332, -1.0: 0.5433333333333333, -2.0: 0.52, -3.0: 0.39999999999999997, -4.0: 0.4166666666666666, -5.0: 0.4466666666666667, -6.0: 0.4866666666666666, -7.0: 0.48999999999999994, -8.0: 0.25333333333333324, -9.0: 0.2866666666666666, -10.0: 0.18000000000000002, -11.0: 0.19000000000000009, -12.0: 0.19999999999999987, -13.0: 0.2066666666666667, -14.0: 0.09333333333333342, -15.0: 0.0}
